<!DOCTYPE html>
<html lang="zh-cn">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  <meta name="author" content="Ray">
  
  
  
  <link rel="prev" href="https://blog.qiyuex.top/2020/%E5%89%8D%E8%A8%80/" />
  
  <link rel="canonical" href="https://blog.qiyuex.top/2020/python%E6%B1%82select%E9%9B%86/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#483d8b">
  <meta name="msapplication-TileColor" content="#603cba">
  <meta name="theme-color" content="#000000">
  <title>
       
       
           Python求Select集 | QiYue&#39;s Blog
       
  </title>
  <meta name="title" content="Python求Select集 | QiYue&#39;s Blog">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
 "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https:\/\/blog.qiyuex.top"
    },
    "articleSection" : "posts",
    "name" : "Python求Select集",
    "headline" : "Python求Select集",
    "description" : "编译原理求First集Follow集Select集",
    "inLanguage" : "zh-cn",
    "author" : "Ray",
    "creator" : "Ray",
    "publisher": "Ray",
    "accountablePerson" : "Ray",
    "copyrightHolder" : "Ray",
    "copyrightYear" : "2020",
    "datePublished": "2020-07-16 17:53:22 \x2b0800 CST",
    "dateModified" : "2020-07-16 17:53:22 \x2b0800 CST",
    "url" : "https:\/\/blog.qiyuex.top\/2020\/python%E6%B1%82select%E9%9B%86\/",
    "wordCount" : "3542",
    "keywords" : [ "编译原理","Python","学习日记", "QiYue\x27s Blog"]
}
</script>

</head>

  


  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://blog.qiyuex.top">QiYue&#39;s Blog</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://blog.qiyuex.top">QiYue&#39;s Blog</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
      		
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">Python求Select集</h1>
        <div class="post-meta">
                Written by <a itemprop="name" href="https://blog.qiyuex.top" rel="author">Ray</a> with ♥ 
                <span class="post-time">
                on <time datetime=2020-07-16 itemprop="datePublished">July 16, 2020</time>
                </span>
                in
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        <a href="https://blog.qiyuex.top/categories/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/"> 软件开发 </a>
                        
                </span>
                <span class="post-word-count">, 3542 words,</span>
                
                <span id="/2020/python%E6%B1%82select%E9%9B%86/" class="leancloud_visitors" data-flag-title="Python求Select集">
                    <i class="leancloud-visitors-count">1000000</i>
                    <em class="post-meta-item-text"> hits</em>
                </span>
        </div>
    </header>
    <div class="post-content">
        

        

        
        
     
          
          
          

          
          
          

          <p>刚刚整完编译原理的课设报告，突然想起来求Select的时候遇到的各种坑，想到当时网上各种资料的错误和不全面，然后又想到万年没更新过的博客，特地来更新一下。</p>
<h2 id="准备工作">准备工作</h2>
<blockquote>
<p>既然要用<code>Python</code>求Select集，那至少得知道手动怎么求吧（笑</p>
</blockquote>
<p>众所周知，求Select集首先需要求得First集和Follow集，先来看一看定义：</p>
<h3 id="first集合">First集合</h3>
<p>顾名思义，First集就是一个文法符号串，所可能推导出的符号串中，第一个终结符构成的集合。</p>
<p>如果还是不理解的话，举个例子：First(X) 就是求X所有能推导出内容中第一个终结符的集合。</p>
<p>求First集分为：</p>
<ol>
<li>
<p>求终结符的First集：终结符的First集是他本身。</p>
</li>
<li>
<p>求非终结符的First集：</p>
<ul>
<li>
<p>若A-&gt;a，则根据定义，a $\in$ First(A)。</p>
</li>
<li>
<p>若A-&gt;B，同样根据定义，First(B) $\subseteq$ First(A)。</p>
</li>
</ul>
</li>
<li>
<p>求符号串的First集（例如ABC）：</p>
<ol>
<li>第一步：看串首是否为终结符或不能推导出ε（空）的非终结符。
<ul>
<li>若是终结符，则First(ABC) = { 该终结符 }；</li>
<li>若是不能推导出ε的非终结符，则First(ABC) =  First(A)；</li>
<li>若非上述情况，则First(A) - ε $\subseteq$ First(ABC)，并进行下一步。</li>
</ul>
</li>
<li>第二步：若串首非终结符能推出ε，当其推出空时，符号串将变为BC。
<ul>
<li>重复第一步的操作，即查看随后的符号是否为终结符或或不能推导出ε的非终结符，并按第一步操作。</li>
<li>若不能推出ε则结束循环。</li>
</ul>
</li>
</ol>
</li>
</ol>
<p>注意事项：First集合中的符号一定是终结符，终结符也包括空串ε。</p>
<h3 id="follow集合">Follow集合</h3>
<p>同样，顾名思义，Follow集就是非终结符后面可能跟随的终结符的集合（不包括ε）。</p>
<p>求Follow集分为：</p>
<ol>
<li>
<p><code>A-&gt;...Bc...</code>型：根据定义，c $\in$ Follow(B)。</p>
</li>
<li>
<p><code>A-&gt;...BC...</code>型：根据定义，First(C) $\subseteq$ Follow(B)。</p>
</li>
<li>
<p><code>A-&gt;...C</code>型：文法左部的Follow集包含于串尾非终结符的Follow集。本例中Follow(A) $\subseteq$ Follow(C)。</p>
</li>
<li>
<p><code>A-&gt;...BC</code>这一类较为特殊，处理方法如下：</p>
<ul>
<li>
<p>该类型是<code>A-&gt;...BC...</code>型和<code>A-&gt;...C</code>型的特例情况，除了要按<code>A-&gt;...BC...</code>型的情况处理，将First(C) $\subseteq$ Follow(B)，还要进行以下操作：</p>
<ol>
<li>
<p>第一步：看串尾C能否推导出ε。</p>
<ul>
<li>
<p>若不能推导出空，则同<code>A-&gt;...C</code>型操作，将Follow(A) $\subseteq$ Follow(C)。</p>
</li>
<li>
<p>若能推导出空，则Follow(A)也属于Follow(B)，即Follow(A) $\subseteq$ Follow(B)，并进行下一步。</p>
</li>
</ul>
</li>
<li>
<p>第二步：若串尾非终结符能推导出ε，当其推空时，符号串将变为<code>A-&gt;...B</code>。</p>
<ul>
<li>重复第一步操作，即判断当前串尾符号B能否推导出ε，并按第一步操作。</li>
<li>若不能推出ε则结束循环。</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ol>
<p>注意事项：Follow集合中的符号一定是终结符，并且不包括空串ε，而且定义<strong>开始符号</strong> 的Follow集合包含 <code>#</code> 。</p>
<h3 id="select集合">Select集合</h3>
<p>Select集合则是产生式左部的可能的推导结果的起始符号。</p>
<p>举个例子：Select(A-&gt;B)就是求这个文法产生式中A可能推导出起始符号集合。</p>
<p>求Select集分为：</p>
<ol>
<li><code>A–&gt;X（X为任意串且X不能推导出空）</code>型：根据定义，Select(A–&gt;X) = First(X)。</li>
<li><code>A–&gt;X（X为任意串且X能推导出空）</code>型：
<ul>
<li>当X不推导出空时，First(X) $\subseteq$ Select(A–&gt;X)</li>
<li>当X推导出空时，A推导出的符号串就会是A后面的符号的推导结果，即Follow(A)，故Follow(A) $\subseteq$ Select(A–&gt;X)</li>
<li>所以 Select(A–&gt;X) = First(X) $\cup$ Follow(A)</li>
</ul>
</li>
</ol>
<h2 id="利用python自动求select集">利用Python自动求Select集</h2>
<blockquote>
<p>有了上面这些前置知识，就可以着手用程序求这些集合了！</p>
</blockquote>
<p>程序求法与人工求法有些许不同，具体表现在程序是顺序执行的，没有人工求那么灵活，所以可能需要运行多次才能得出正确结果~</p>
<h3 id="大致思路">大致思路</h3>
<ol>
<li>
<p>求First集：</p>
<ul>
<li>
<p>先求First集第一个部分：针对-&gt;直接推出第一个字符为终结符部分，直接将其加入非终结符的First集中。</p>
</li>
<li>
<p>再循环求出First集第二部分：针对A -&gt; B型，反复把B的first集加到A的first集合中并去重，直到集合不再扩大为止。</p>
</li>
</ul>
</li>
<li>
<p>求Follow集：</p>
<ul>
<li>将非终结符后的终结符加入非终结符的Follow集</li>
<li>将非终结符后跟非终结符的First集加入前者的Follow集</li>
<li>当非终结符在末尾时，将生成式左侧的Follow集加入末尾非终结符的Follow集</li>
<li>若句末非终结符的First集包含空，则也将生成式左侧的Follow集加入倒数第二个位置上的非终结符的Follow集中，重复向前直到遇到终结符或First集中不含空的非终结符。</li>
</ul>
<p>循环上述过程并去重，直到集合不再扩大为止。</p>
</li>
<li>
<p>求Select集：</p>
<p>针对A-&gt;X，分为两种情况讨论：</p>
<ul>
<li>
<p>若X不能推导出空，则根据定义，A的Select集应当为First（X）</p>
</li>
<li>
<p>若X能推导出空，则根据定义， First（X）属于A的Select集，此外，Follow（A）也属于A的Select集。</p>
</li>
</ul>
</li>
</ol>
<h3 id="代码实现">代码实现</h3>
<p>我个人实现的代码算是覆盖了大多数情况，暂时没有发现什么Bug。</p>
<p>若要使用大概需要注意：</p>
<ul>
<li>文法中各符号用空格分开</li>
<li>非终结符用<code>&lt; &gt;</code>包裹(也可以通过修改<code>判断非终结符的函数</code>修改非终结符样式)</li>
<li>结果保存在 <code>self.FIRST</code>、  <code>self.FOLLOW</code> 、 <code>self.SELECT</code>三个字典中，也可以通过去除<code>run_cal</code>函数中<code>self.debug_out()</code>前的注释符号 <code>#</code> 实现在控制台输出上述三个集合。</li>
</ul>
<p><a href="https://www.qiyuex.top/download/BlogDownload/cal_select.py">代码下载</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 判断非终结符的函数</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">isnonterminal</span>(symbol):
    <span style="color:#66d9ef">if</span> symbol[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;&lt;&#39;</span> <span style="color:#f92672">and</span> symbol[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;&gt;&#39;</span>:
        <span style="color:#66d9ef">return</span> True
    <span style="color:#66d9ef">return</span> False


<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CalSelect</span>(object):
    <span style="color:#66d9ef">def</span> __init__(self):
        <span style="color:#75715e"># 初始化集合字典</span>
        self<span style="color:#f92672">.</span>FIRST <span style="color:#f92672">=</span> {}
        self<span style="color:#f92672">.</span>FOLLOW <span style="color:#f92672">=</span> {}
        self<span style="color:#f92672">.</span>SELECT <span style="color:#f92672">=</span> {}
        <span style="color:#75715e"># 初始化文法</span>
        self<span style="color:#f92672">.</span>grammar <span style="color:#f92672">=</span> [
			<span style="color:#75715e"># 文法填在此处</span>
			<span style="color:#e6db74">&#34;&lt;E&gt;-&gt;&lt;T&gt; &lt;E&#39;&gt;&#34;</span>,
			<span style="color:#e6db74">&#34;&lt;E&#39;&gt;-&gt;+ &lt;T&gt; &lt;E&#39;&gt;&#34;</span>,
			<span style="color:#e6db74">&#34;&lt;E&#39;&gt;-&gt;ε&#34;</span>,
			<span style="color:#e6db74">&#34;&lt;T&gt;-&gt;&lt;F&gt; &lt;T&#39;&gt;&#34;</span>,
			<span style="color:#e6db74">&#34;&lt;T&#39;&gt;-&gt;* &lt;F&gt; &lt;T&#39;&gt;&#34;</span>,
			<span style="color:#e6db74">&#34;&lt;T&#39;&gt;-&gt;ε&#34;</span>,
			<span style="color:#e6db74">&#34;&lt;F&gt;-&gt;( &lt;E&gt; )&#34;</span>,
			<span style="color:#e6db74">&#34;&lt;F&gt;-&gt;i&#34;</span>
        ]
        <span style="color:#75715e"># 初始化终结符</span>
        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(self<span style="color:#f92672">.</span>grammar)):
            self<span style="color:#f92672">.</span>grammar[i] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>grammar[i]<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;函数名&#39;</span>, <span style="color:#e6db74">&#39;FT&#39;</span>)
            self<span style="color:#f92672">.</span>grammar[i] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>grammar[i]<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;变量名&#39;</span>, <span style="color:#e6db74">&#39;iT&#39;</span>)
            self<span style="color:#f92672">.</span>grammar[i] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>grammar[i]<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;常数&#39;</span>, <span style="color:#e6db74">&#39;CT&#39;</span>)
            self<span style="color:#f92672">.</span>grammar[i] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>grammar[i]<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;字符串&#39;</span>, <span style="color:#e6db74">&#39;sT&#39;</span>)
            self<span style="color:#f92672">.</span>grammar[i] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>grammar[i]<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;字符&#39;</span>, <span style="color:#e6db74">&#39;cT&#39;</span>)
        <span style="color:#75715e"># 初始化first集、follow集和select集字典的键值对中的值为空</span>
        <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>grammar:
            part_begin <span style="color:#f92672">=</span> line<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;-&gt;&#34;</span>)[<span style="color:#ae81ff">0</span>]
            part_end_temp <span style="color:#f92672">=</span> line<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;-&gt;&#34;</span>)[<span style="color:#ae81ff">1</span>]
            part_end <span style="color:#f92672">=</span> part_end_temp<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34; &#34;</span>)
            self<span style="color:#f92672">.</span>FIRST[part_begin] <span style="color:#f92672">=</span> []
            self<span style="color:#f92672">.</span>FOLLOW[part_begin] <span style="color:#f92672">=</span> []
            self<span style="color:#f92672">.</span>SELECT[line] <span style="color:#f92672">=</span> []
        self<span style="color:#f92672">.</span>FOLLOW[self<span style="color:#f92672">.</span>grammar[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;-&gt;&#34;</span>)[<span style="color:#ae81ff">0</span>]]<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#39;#&#39;</span>)

    <span style="color:#75715e"># 求first集中第一部分：针对-&gt;直接推出第一个字符为终结符部分</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getFirst</span>(self):
        <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>grammar:
            part_begin <span style="color:#f92672">=</span> line<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;-&gt;&#34;</span>)[<span style="color:#ae81ff">0</span>]
            part_end_temp <span style="color:#f92672">=</span> line<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;-&gt;&#34;</span>)[<span style="color:#ae81ff">1</span>]
            part_end <span style="color:#f92672">=</span> part_end_temp<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34; &#34;</span>)
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> isnonterminal(part_end[<span style="color:#ae81ff">0</span>]):
                self<span style="color:#f92672">.</span>FIRST[part_begin]<span style="color:#f92672">.</span>append(part_end[<span style="color:#ae81ff">0</span>])

    <span style="color:#75715e"># 求first第二部分：针对A -&gt; B型，把B的first集加到A的first集合中</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getFirst_2</span>(self):
        <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>grammar:
            part_begin <span style="color:#f92672">=</span> line<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;-&gt;&#34;</span>)[<span style="color:#ae81ff">0</span>]
            part_end_temp <span style="color:#f92672">=</span> line<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;-&gt;&#34;</span>)[<span style="color:#ae81ff">1</span>]
            part_end <span style="color:#f92672">=</span> part_end_temp<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34; &#34;</span>)
            <span style="color:#75715e"># 如果型如A -&gt; B：则把B的first集加到A的first集中去</span>
            <span style="color:#66d9ef">if</span> isnonterminal(part_end[<span style="color:#ae81ff">0</span>]):
                <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(part_end)):
                    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> isnonterminal(part_end[i]):
                        self<span style="color:#f92672">.</span>FIRST[part_begin]<span style="color:#f92672">.</span>append(part_end[i])
                        <span style="color:#66d9ef">break</span>
                    list_remove <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>FIRST<span style="color:#f92672">.</span>get(part_end[i])<span style="color:#f92672">.</span>copy()
                    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;ε&#39;</span> <span style="color:#f92672">in</span> list_remove <span style="color:#f92672">and</span> i <span style="color:#f92672">is</span> <span style="color:#f92672">not</span> len(part_end) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>:
                        list_remove<span style="color:#f92672">.</span>remove(<span style="color:#e6db74">&#39;ε&#39;</span>)
                    self<span style="color:#f92672">.</span>FIRST[part_begin]<span style="color:#f92672">.</span>extend(list_remove)
                    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;ε&#39;</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>FIRST[part_end[i]]:
                        <span style="color:#66d9ef">break</span>

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getFirst_3</span>(self):
        <span style="color:#66d9ef">while</span> <span style="color:#ae81ff">1</span>:
            test <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>FIRST
            self<span style="color:#f92672">.</span>getFirst_2()
            <span style="color:#75715e"># 去除重复项</span>
            <span style="color:#66d9ef">for</span> i, j <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>FIRST<span style="color:#f92672">.</span>items():
                temp <span style="color:#f92672">=</span> []
                <span style="color:#66d9ef">for</span> word <span style="color:#f92672">in</span> list(set(j)):
                    temp<span style="color:#f92672">.</span>append(word)
                self<span style="color:#f92672">.</span>FIRST[i] <span style="color:#f92672">=</span> temp
            <span style="color:#66d9ef">if</span> test <span style="color:#f92672">==</span> self<span style="color:#f92672">.</span>FIRST:
                <span style="color:#66d9ef">break</span>

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getFOLLOW_3</span>(self):
        <span style="color:#66d9ef">while</span> <span style="color:#ae81ff">1</span>:
            test <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>FOLLOW
            self<span style="color:#f92672">.</span>getFollow()
            <span style="color:#75715e"># 去除重复项</span>
            <span style="color:#66d9ef">for</span> i, j <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>FOLLOW<span style="color:#f92672">.</span>items():
                temp <span style="color:#f92672">=</span> []
                <span style="color:#66d9ef">for</span> word <span style="color:#f92672">in</span> list(set(j)):
                    temp<span style="color:#f92672">.</span>append(word)
                self<span style="color:#f92672">.</span>FOLLOW[i] <span style="color:#f92672">=</span> temp
            <span style="color:#66d9ef">if</span> test <span style="color:#f92672">==</span> self<span style="color:#f92672">.</span>FOLLOW:
                <span style="color:#66d9ef">break</span>

    <span style="color:#75715e"># 计算follow集的第一部分，先计算 S -&gt; A b 类型的</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getFollow</span>(self):
        <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>grammar:
            part_begin <span style="color:#f92672">=</span> line<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;-&gt;&#34;</span>)[<span style="color:#ae81ff">0</span>]
            part_end_temp <span style="color:#f92672">=</span> line<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;-&gt;&#34;</span>)[<span style="color:#ae81ff">1</span>]
            part_end <span style="color:#f92672">=</span> part_end_temp<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34; &#34;</span>)
            <span style="color:#66d9ef">if</span> part_begin <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&lt;G&gt;&#34;</span>:
                <span style="color:#66d9ef">pass</span>
            <span style="color:#75715e"># 如果是 S-&gt;a 直接推出终结符 则 continue</span>
            <span style="color:#66d9ef">if</span> len(part_end) <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">and</span> <span style="color:#f92672">not</span> isnonterminal(part_end[<span style="color:#ae81ff">0</span>]):
                <span style="color:#66d9ef">continue</span>
            <span style="color:#75715e"># 否则执行下面的操作</span>
            <span style="color:#66d9ef">else</span>:
                <span style="color:#75715e"># 将-&gt;后面的倒序</span>
                part_end<span style="color:#f92672">.</span>reverse()
                <span style="color:#75715e"># 最后一个为非终结符</span>
                <span style="color:#66d9ef">if</span> isnonterminal(part_end[<span style="color:#ae81ff">0</span>]):

                    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(part_end)):
                        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> isnonterminal(part_end[i]):
                            <span style="color:#66d9ef">break</span>
                        self<span style="color:#f92672">.</span>FOLLOW[part_end[i]]<span style="color:#f92672">.</span>extend(self<span style="color:#f92672">.</span>FOLLOW<span style="color:#f92672">.</span>get(part_begin))
                        <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;ε&#39;</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>FIRST[part_end[i]]:
                            <span style="color:#66d9ef">break</span>

                    terminal_temp <span style="color:#f92672">=</span> part_end[<span style="color:#ae81ff">0</span>]
                    <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> part_end[<span style="color:#ae81ff">1</span>:]:
                        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> isnonterminal(item):
                            terminal_temp <span style="color:#f92672">=</span> item
                        <span style="color:#66d9ef">else</span>:
                            <span style="color:#66d9ef">if</span> isnonterminal(terminal_temp):
                                list_remove <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>FIRST<span style="color:#f92672">.</span>get(terminal_temp)<span style="color:#f92672">.</span>copy()
                                <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;ε&#34;</span> <span style="color:#f92672">in</span> list_remove:
                                    list_remove<span style="color:#f92672">.</span>remove(<span style="color:#e6db74">&#34;ε&#34;</span>)
                                self<span style="color:#f92672">.</span>FOLLOW[item]<span style="color:#f92672">.</span>extend(list_remove)
                            <span style="color:#66d9ef">elif</span> terminal_temp <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;ε&#39;</span>:
                                self<span style="color:#f92672">.</span>FOLLOW[item]<span style="color:#f92672">.</span>append(terminal_temp)
                            terminal_temp <span style="color:#f92672">=</span> item
                <span style="color:#75715e"># 如果终结符在句型的末端</span>
                <span style="color:#66d9ef">else</span>:
                    terminal_temp <span style="color:#f92672">=</span> part_end[<span style="color:#ae81ff">0</span>]
                    <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> part_end[<span style="color:#ae81ff">1</span>:]:
                        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> isnonterminal(item):
                            terminal_temp <span style="color:#f92672">=</span> item
                        <span style="color:#66d9ef">else</span>:
                            <span style="color:#66d9ef">if</span> isnonterminal(terminal_temp):
                                list_remove <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>FIRST<span style="color:#f92672">.</span>get(terminal_temp)<span style="color:#f92672">.</span>copy()
                                <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;ε&#34;</span> <span style="color:#f92672">in</span> list_remove:
                                    list_remove<span style="color:#f92672">.</span>remove(<span style="color:#e6db74">&#34;ε&#34;</span>)
                                self<span style="color:#f92672">.</span>FOLLOW[item]<span style="color:#f92672">.</span>extend(list_remove)
                            <span style="color:#66d9ef">elif</span> terminal_temp <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;ε&#39;</span>:
                                self<span style="color:#f92672">.</span>FOLLOW[item]<span style="color:#f92672">.</span>append(terminal_temp)
                            terminal_temp <span style="color:#f92672">=</span> item

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getSelect</span>(self):
        <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>grammar:
            part_begin <span style="color:#f92672">=</span> line<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;-&gt;&#34;</span>)[<span style="color:#ae81ff">0</span>]
            part_end_temp <span style="color:#f92672">=</span> line<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;-&gt;&#34;</span>)[<span style="color:#ae81ff">1</span>]
            part_end <span style="color:#f92672">=</span> part_end_temp<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34; &#34;</span>)
            line_first <span style="color:#f92672">=</span> []
            <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> part_end:
                <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> isnonterminal(item):
                    line_first<span style="color:#f92672">.</span>append(item)
                    <span style="color:#66d9ef">break</span>
                <span style="color:#66d9ef">else</span>:
                    line_first<span style="color:#f92672">.</span>extend(self<span style="color:#f92672">.</span>FIRST[item])
                    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;ε&#39;</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>FIRST[item]:
                        <span style="color:#66d9ef">break</span>
            line_first <span style="color:#f92672">=</span> list(set(line_first))
            can_derive_empty <span style="color:#f92672">=</span> True
            part_end<span style="color:#f92672">.</span>reverse()
            <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> part_end:
                <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> isnonterminal(item):
                    <span style="color:#66d9ef">if</span> item <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;ε&#39;</span>:
                        can_derive_empty <span style="color:#f92672">=</span> False
                        <span style="color:#66d9ef">break</span>
                <span style="color:#66d9ef">else</span>:
                    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;ε&#39;</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>FIRST[item]:
                        can_derive_empty <span style="color:#f92672">=</span> False
                        <span style="color:#66d9ef">break</span>
            list_remove <span style="color:#f92672">=</span> line_first<span style="color:#f92672">.</span>copy()
            <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;ε&#34;</span> <span style="color:#f92672">in</span> list_remove:
                list_remove<span style="color:#f92672">.</span>remove(<span style="color:#e6db74">&#34;ε&#34;</span>)
            <span style="color:#66d9ef">if</span> can_derive_empty:
                self<span style="color:#f92672">.</span>SELECT[line]<span style="color:#f92672">.</span>extend(list_remove)
                self<span style="color:#f92672">.</span>SELECT[line]<span style="color:#f92672">.</span>extend(self<span style="color:#f92672">.</span>FOLLOW[part_begin])
            <span style="color:#66d9ef">else</span>:
                self<span style="color:#f92672">.</span>SELECT[line]<span style="color:#f92672">.</span>extend(list_remove)
            self<span style="color:#f92672">.</span>SELECT[line] <span style="color:#f92672">=</span> list(set(self<span style="color:#f92672">.</span>SELECT[line]))

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">debug_out</span>(self):
        <span style="color:#66d9ef">for</span> i, j <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>FIRST<span style="color:#f92672">.</span>items():
            str <span style="color:#f92672">=</span> j[<span style="color:#ae81ff">0</span>]
            <span style="color:#66d9ef">for</span> temp <span style="color:#f92672">in</span> j[<span style="color:#ae81ff">1</span>:]:
                str <span style="color:#f92672">=</span> str <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;,&#39;</span> <span style="color:#f92672">+</span> temp
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;FIRST(&#34;</span> <span style="color:#f92672">+</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;)&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; = {&#34;</span> <span style="color:#f92672">+</span> str <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;}&#34;</span>)

        <span style="color:#66d9ef">for</span> i, j <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>FOLLOW<span style="color:#f92672">.</span>items():
            str <span style="color:#f92672">=</span> j[<span style="color:#ae81ff">0</span>]
            <span style="color:#66d9ef">for</span> temp <span style="color:#f92672">in</span> j[<span style="color:#ae81ff">1</span>:]:
                str <span style="color:#f92672">=</span> str <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;,&#39;</span> <span style="color:#f92672">+</span> temp
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;FOLLOW(&#34;</span> <span style="color:#f92672">+</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;)&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; = {&#34;</span> <span style="color:#f92672">+</span> str <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;}&#34;</span>)
        <span style="color:#66d9ef">for</span> i, j <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>SELECT<span style="color:#f92672">.</span>items():
            str <span style="color:#f92672">=</span> j[<span style="color:#ae81ff">0</span>]
            <span style="color:#66d9ef">for</span> temp <span style="color:#f92672">in</span> j[<span style="color:#ae81ff">1</span>:]:
                str <span style="color:#f92672">=</span> str <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;,&#39;</span> <span style="color:#f92672">+</span> temp
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;SELECT(&#34;</span> <span style="color:#f92672">+</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;)&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; = {&#34;</span> <span style="color:#f92672">+</span> str <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;}&#34;</span>)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run_cal</span>(self):
        self<span style="color:#f92672">.</span>getFirst()
        self<span style="color:#f92672">.</span>getFirst_3()
        self<span style="color:#f92672">.</span>getFirst_3()
        self<span style="color:#f92672">.</span>getFOLLOW_3()
        self<span style="color:#f92672">.</span>getFOLLOW_3()
        self<span style="color:#f92672">.</span>getSelect()
        <span style="color:#75715e"># self.debug_out()</span>


<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
    CalSelect()<span style="color:#f92672">.</span>run_cal()

</code></pre></div>
    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>Ray </span>
                </p>
            
           
             
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=https://blog.qiyuex.top/2020/python%E6%B1%82select%E9%9B%86/>https://blog.qiyuex.top/2020/python%E6%B1%82select%E9%9B%86/</span>
            </p>
            
             
            <p class="copyright-item lincese">
                本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。
            </p>
            
    </div>

  
    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-tag"></i>Tag(s): 
            
            <span class="tag"><a href="https://blog.qiyuex.top/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/">
                    #编译原理</a></span>
            
            <span class="tag"><a href="https://blog.qiyuex.top/tags/python/">
                    #Python</a></span>
            
            <span class="tag"><a href="https://blog.qiyuex.top/tags/%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/">
                    #学习日记</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> · 
                <span><a href="https://blog.qiyuex.top">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://blog.qiyuex.top/2020/%E5%89%8D%E8%A8%80/" class="prev" rel="prev" title="前言"><i class="iconfont icon-left"></i>&nbsp;前言</a>
         
        
    </div>

    <div class="post-comment">
          
                 
          
          <div id="vcomments"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>

<script type="text/javascript">
  new Valine({
	  el: '#vcomments' ,
	  appId: 'LRdGXLYwaNDfkOsCCytrrA8L-gzGzoHsz',
	  appKey: '1mkIUd25e8WzN6xUQU8otIsL',
	  notify: 'false', 
	  verify: 'false', 
	  avatar:'mp', 
	  placeholder: 'Σ(っ °Д °;)っ你咋不评论就想走啊！',
	  visitor: 'true'
  });
</script>
    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2018 - 2020</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="https://blog.qiyuex.top">Ray</a> | </span> 
         

         
		  <span>Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> & <a href="https://qiyuex.top" target="_blank" rel="external nofollow">Ray</a></span> 
    </div>
</footer>












    
    
    <script src="/js/vendor_no_gallery.min.js" async=""></script>
    
  



     </div>
  </body>
</html>
